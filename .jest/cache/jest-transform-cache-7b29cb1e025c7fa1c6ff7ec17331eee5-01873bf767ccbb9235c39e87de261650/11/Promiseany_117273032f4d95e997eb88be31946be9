ce9cec1785566f35d4d549e73a7a5903
"use strict";

function _typeof(obj) {
  "@babel/helpers - typeof";

  return _typeof = "function" == typeof Symbol && "symbol" == typeof Symbol.iterator ? function (obj) {
    return typeof obj;
  } : function (obj) {
    return obj && "function" == typeof Symbol && obj.constructor === Symbol && obj !== Symbol.prototype ? "symbol" : typeof obj;
  }, _typeof(obj);
}

exports.__esModule = true;
exports["default"] = exports.AggregatedError = void 0;

var _ramda = require("ramda");

var _resolveP = _interopRequireDefault(require("../../resolveP"));

function _interopRequireDefault(obj) {
  return obj && obj.__esModule ? obj : {
    "default": obj
  };
}

function _toConsumableArray(arr) {
  return _arrayWithoutHoles(arr) || _iterableToArray(arr) || _unsupportedIterableToArray(arr) || _nonIterableSpread();
}

function _nonIterableSpread() {
  throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.");
}

function _unsupportedIterableToArray(o, minLen) {
  if (!o) return;
  if (typeof o === "string") return _arrayLikeToArray(o, minLen);
  var n = Object.prototype.toString.call(o).slice(8, -1);
  if (n === "Object" && o.constructor) n = o.constructor.name;
  if (n === "Map" || n === "Set") return Array.from(o);
  if (n === "Arguments" || /^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)) return _arrayLikeToArray(o, minLen);
}

function _iterableToArray(iter) {
  if (typeof Symbol !== "undefined" && iter[Symbol.iterator] != null || iter["@@iterator"] != null) return Array.from(iter);
}

function _arrayWithoutHoles(arr) {
  if (Array.isArray(arr)) return _arrayLikeToArray(arr);
}

function _arrayLikeToArray(arr, len) {
  if (len == null || len > arr.length) len = arr.length;

  for (var i = 0, arr2 = new Array(len); i < len; i++) {
    arr2[i] = arr[i];
  }

  return arr2;
}

function _defineProperties(target, props) {
  for (var i = 0; i < props.length; i++) {
    var descriptor = props[i];
    descriptor.enumerable = descriptor.enumerable || false;
    descriptor.configurable = true;
    if ("value" in descriptor) descriptor.writable = true;
    Object.defineProperty(target, descriptor.key, descriptor);
  }
}

function _createClass(Constructor, protoProps, staticProps) {
  if (protoProps) _defineProperties(Constructor.prototype, protoProps);
  if (staticProps) _defineProperties(Constructor, staticProps);
  Object.defineProperty(Constructor, "prototype", {
    writable: false
  });
  return Constructor;
}

function _classCallCheck(instance, Constructor) {
  if (!(instance instanceof Constructor)) {
    throw new TypeError("Cannot call a class as a function");
  }
}

function _inherits(subClass, superClass) {
  if (typeof superClass !== "function" && superClass !== null) {
    throw new TypeError("Super expression must either be null or a function");
  }

  subClass.prototype = Object.create(superClass && superClass.prototype, {
    constructor: {
      value: subClass,
      writable: true,
      configurable: true
    }
  });
  Object.defineProperty(subClass, "prototype", {
    writable: false
  });
  if (superClass) _setPrototypeOf(subClass, superClass);
}

function _createSuper(Derived) {
  var hasNativeReflectConstruct = _isNativeReflectConstruct();

  return function _createSuperInternal() {
    var Super = _getPrototypeOf(Derived),
        result;

    if (hasNativeReflectConstruct) {
      var NewTarget = _getPrototypeOf(this).constructor;

      result = Reflect.construct(Super, arguments, NewTarget);
    } else {
      result = Super.apply(this, arguments);
    }

    return _possibleConstructorReturn(this, result);
  };
}

function _possibleConstructorReturn(self, call) {
  if (call && (_typeof(call) === "object" || typeof call === "function")) {
    return call;
  } else if (call !== void 0) {
    throw new TypeError("Derived constructors may only return object or undefined");
  }

  return _assertThisInitialized(self);
}

function _assertThisInitialized(self) {
  if (self === void 0) {
    throw new ReferenceError("this hasn't been initialised - super() hasn't been called");
  }

  return self;
}

function _wrapNativeSuper(Class) {
  var _cache = typeof Map === "function" ? new Map() : undefined;

  _wrapNativeSuper = function _wrapNativeSuper(Class) {
    if (Class === null || !_isNativeFunction(Class)) return Class;

    if (typeof Class !== "function") {
      throw new TypeError("Super expression must either be null or a function");
    }

    if (typeof _cache !== "undefined") {
      if (_cache.has(Class)) return _cache.get(Class);

      _cache.set(Class, Wrapper);
    }

    function Wrapper() {
      return _construct(Class, arguments, _getPrototypeOf(this).constructor);
    }

    Wrapper.prototype = Object.create(Class.prototype, {
      constructor: {
        value: Wrapper,
        enumerable: false,
        writable: true,
        configurable: true
      }
    });
    return _setPrototypeOf(Wrapper, Class);
  };

  return _wrapNativeSuper(Class);
}

function _construct(Parent, args, Class) {
  if (_isNativeReflectConstruct()) {
    _construct = Reflect.construct;
  } else {
    _construct = function _construct(Parent, args, Class) {
      var a = [null];
      a.push.apply(a, args);
      var Constructor = Function.bind.apply(Parent, a);
      var instance = new Constructor();
      if (Class) _setPrototypeOf(instance, Class.prototype);
      return instance;
    };
  }

  return _construct.apply(null, arguments);
}

function _isNativeReflectConstruct() {
  if (typeof Reflect === "undefined" || !Reflect.construct) return false;
  if (Reflect.construct.sham) return false;
  if (typeof Proxy === "function") return true;

  try {
    Boolean.prototype.valueOf.call(Reflect.construct(Boolean, [], function () {}));
    return true;
  } catch (e) {
    return false;
  }
}

function _isNativeFunction(fn) {
  return Function.toString.call(fn).indexOf("[native code]") !== -1;
}

function _setPrototypeOf(o, p) {
  _setPrototypeOf = Object.setPrototypeOf || function _setPrototypeOf(o, p) {
    o.__proto__ = p;
    return o;
  };

  return _setPrototypeOf(o, p);
}

function _getPrototypeOf(o) {
  _getPrototypeOf = Object.setPrototypeOf ? Object.getPrototypeOf : function _getPrototypeOf(o) {
    return o.__proto__ || Object.getPrototypeOf(o);
  };
  return _getPrototypeOf(o);
}

var AggregatedError = function (_Error) {
  _inherits(AggregatedError, _Error);

  var _super = _createSuper(AggregatedError);

  function AggregatedError() {
    var _this;

    var errors = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : [];
    var message = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : '';

    _classCallCheck(this, AggregatedError);

    _this = _super.call(this, message);
    _this.errors = errors;
    return _this;
  }

  return _createClass(AggregatedError);
}(_wrapNativeSuper(Error));

exports.AggregatedError = AggregatedError;

var anyPonyfill = function anyPonyfill(iterable) {
  var exceptions = [];
  return new Promise(function (resolve, reject) {
    var onReject = function onReject(e) {
      exceptions.push(e);

      if (exceptions.length === iterable.length) {
        reject(new AggregatedError(exceptions));
      }
    };

    (0, _ramda.map)(function (p) {
      return (0, _resolveP["default"])(p).then(resolve)["catch"](onReject);
    }, _toConsumableArray(iterable));
  });
};

var _default = anyPonyfill;
exports["default"] = _default;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIlByb21pc2UuYW55LmpzIl0sIm5hbWVzIjpbIl90eXBlb2YiLCJvYmoiLCJTeW1ib2wiLCJpdGVyYXRvciIsImNvbnN0cnVjdG9yIiwicHJvdG90eXBlIiwiZXhwb3J0cyIsIl9fZXNNb2R1bGUiLCJBZ2dyZWdhdGVkRXJyb3IiLCJfcmFtZGEiLCJyZXF1aXJlIiwiX3Jlc29sdmVQIiwiX2ludGVyb3BSZXF1aXJlRGVmYXVsdCIsIl90b0NvbnN1bWFibGVBcnJheSIsImFyciIsIl9hcnJheVdpdGhvdXRIb2xlcyIsIl9pdGVyYWJsZVRvQXJyYXkiLCJfdW5zdXBwb3J0ZWRJdGVyYWJsZVRvQXJyYXkiLCJfbm9uSXRlcmFibGVTcHJlYWQiLCJUeXBlRXJyb3IiLCJvIiwibWluTGVuIiwiX2FycmF5TGlrZVRvQXJyYXkiLCJuIiwiT2JqZWN0IiwidG9TdHJpbmciLCJjYWxsIiwic2xpY2UiLCJuYW1lIiwiQXJyYXkiLCJmcm9tIiwidGVzdCIsIml0ZXIiLCJpc0FycmF5IiwibGVuIiwibGVuZ3RoIiwiaSIsImFycjIiLCJfZGVmaW5lUHJvcGVydGllcyIsInRhcmdldCIsInByb3BzIiwiZGVzY3JpcHRvciIsImVudW1lcmFibGUiLCJjb25maWd1cmFibGUiLCJ3cml0YWJsZSIsImRlZmluZVByb3BlcnR5Iiwia2V5IiwiX2NyZWF0ZUNsYXNzIiwiQ29uc3RydWN0b3IiLCJwcm90b1Byb3BzIiwic3RhdGljUHJvcHMiLCJfY2xhc3NDYWxsQ2hlY2siLCJpbnN0YW5jZSIsIl9pbmhlcml0cyIsInN1YkNsYXNzIiwic3VwZXJDbGFzcyIsImNyZWF0ZSIsInZhbHVlIiwiX3NldFByb3RvdHlwZU9mIiwiX2NyZWF0ZVN1cGVyIiwiRGVyaXZlZCIsImhhc05hdGl2ZVJlZmxlY3RDb25zdHJ1Y3QiLCJfaXNOYXRpdmVSZWZsZWN0Q29uc3RydWN0IiwiX2NyZWF0ZVN1cGVySW50ZXJuYWwiLCJTdXBlciIsIl9nZXRQcm90b3R5cGVPZiIsInJlc3VsdCIsIk5ld1RhcmdldCIsIlJlZmxlY3QiLCJjb25zdHJ1Y3QiLCJhcmd1bWVudHMiLCJhcHBseSIsIl9wb3NzaWJsZUNvbnN0cnVjdG9yUmV0dXJuIiwic2VsZiIsIl9hc3NlcnRUaGlzSW5pdGlhbGl6ZWQiLCJSZWZlcmVuY2VFcnJvciIsIl93cmFwTmF0aXZlU3VwZXIiLCJDbGFzcyIsIl9jYWNoZSIsIk1hcCIsInVuZGVmaW5lZCIsIl9pc05hdGl2ZUZ1bmN0aW9uIiwiaGFzIiwiZ2V0Iiwic2V0IiwiV3JhcHBlciIsIl9jb25zdHJ1Y3QiLCJQYXJlbnQiLCJhcmdzIiwiYSIsInB1c2giLCJGdW5jdGlvbiIsImJpbmQiLCJzaGFtIiwiUHJveHkiLCJCb29sZWFuIiwidmFsdWVPZiIsImUiLCJmbiIsImluZGV4T2YiLCJwIiwic2V0UHJvdG90eXBlT2YiLCJfX3Byb3RvX18iLCJnZXRQcm90b3R5cGVPZiIsIl9FcnJvciIsIl9zdXBlciIsIl90aGlzIiwiZXJyb3JzIiwibWVzc2FnZSIsIkVycm9yIiwiYW55UG9ueWZpbGwiLCJpdGVyYWJsZSIsImV4Y2VwdGlvbnMiLCJQcm9taXNlIiwicmVzb2x2ZSIsInJlamVjdCIsIm9uUmVqZWN0IiwibWFwIiwidGhlbiIsIl9kZWZhdWx0Il0sIm1hcHBpbmdzIjoiQUFBQTs7QUFFQSxTQUFTQSxPQUFULENBQWlCQyxHQUFqQixFQUFzQjtBQUFFOztBQUEyQixTQUFPRCxPQUFPLEdBQUcsY0FBYyxPQUFPRSxNQUFyQixJQUErQixZQUFZLE9BQU9BLE1BQU0sQ0FBQ0MsUUFBekQsR0FBb0UsVUFBVUYsR0FBVixFQUFlO0FBQUUsV0FBTyxPQUFPQSxHQUFkO0FBQW9CLEdBQXpHLEdBQTRHLFVBQVVBLEdBQVYsRUFBZTtBQUFFLFdBQU9BLEdBQUcsSUFBSSxjQUFjLE9BQU9DLE1BQTVCLElBQXNDRCxHQUFHLENBQUNHLFdBQUosS0FBb0JGLE1BQTFELElBQW9FRCxHQUFHLEtBQUtDLE1BQU0sQ0FBQ0csU0FBbkYsR0FBK0YsUUFBL0YsR0FBMEcsT0FBT0osR0FBeEg7QUFBOEgsR0FB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O0FBQ0Q7QUFDRixLQU5EOztBQVFBLEtBQUMsR0FBR3ZHLE1BQU0sQ0FBQzRHLEdBQVgsRUFBZ0IsVUFBVWpCLENBQVYsRUFBYTtBQUMzQixhQUFPLENBQUMsR0FBR3pGLFNBQVMsQ0FBQyxTQUFELENBQWIsRUFBMEJ5RixDQUExQixFQUE2QmtCLElBQTdCLENBQWtDSixPQUFsQyxFQUEyQyxPQUEzQyxFQUFvREUsUUFBcEQsQ0FBUDtBQUNELEtBRkQsRUFFR3ZHLGtCQUFrQixDQUFDa0csUUFBRCxDQUZyQjtBQUdELEdBWk0sQ0FBUDtBQWFELENBZkQ7O0FBaUJBLElBQUlRLFFBQVEsR0FBR1QsV0FBZjtBQUNBeEcsT0FBTyxDQUFDLFNBQUQsQ0FBUCxHQUFxQmlILFFBQXJCIiwic291cmNlc0NvbnRlbnQiOlsiXCJ1c2Ugc3RyaWN0XCI7XG5cbmZ1bmN0aW9uIF90eXBlb2Yob2JqKSB7IFwiQGJhYmVsL2hlbHBlcnMgLSB0eXBlb2ZcIjsgcmV0dXJuIF90eXBlb2YgPSBcImZ1bmN0aW9uXCIgPT0gdHlwZW9mIFN5bWJvbCAmJiBcInN5bWJvbFwiID09IHR5cGVvZiBTeW1ib2wuaXRlcmF0b3IgPyBmdW5jdGlvbiAob2JqKSB7IHJldHVybiB0eXBlb2Ygb2JqOyB9IDogZnVuY3Rpb24gKG9iaikgeyByZXR1cm4gb2JqICYmIFwiZnVuY3Rpb25cIiA9PSB0eXBlb2YgU3ltYm9sICYmIG9iai5jb25zdHJ1Y3RvciA9PT0gU3ltYm9sICYmIG9iaiAhPT0gU3ltYm9sLnByb3RvdHlwZSA/IFwic3ltYm9sXCIgOiB0eXBlb2Ygb2JqOyB9LCBfdHlwZW9mKG9iaik7IH1cblxuZXhwb3J0cy5fX2VzTW9kdWxlID0gdHJ1ZTtcbmV4cG9ydHNbXCJkZWZhdWx0XCJdID0gZXhwb3J0cy5BZ2dyZWdhdGVkRXJyb3IgPSB2b2lkIDA7XG5cbnZhciBfcmFtZGEgPSByZXF1aXJlKFwicmFtZGFcIik7XG5cbnZhciBfcmVzb2x2ZVAgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KHJlcXVpcmUoXCIuLi8uLi9yZXNvbHZlUFwiKSk7XG5cbmZ1bmN0aW9uIF9pbnRlcm9wUmVxdWlyZURlZmF1bHQob2JqKSB7IHJldHVybiBvYmogJiYgb2JqLl9fZXNNb2R1bGUgPyBvYmogOiB7IFwiZGVmYXVsdFwiOiBvYmogfTsgfVxuXG5mdW5jdGlvbiBfdG9Db25zdW1hYmxlQXJyYXkoYXJyKSB7IHJldHVybiBfYXJyYXlXaXRob3V0SG9sZXMoYXJyKSB8fCBfaXRlcmFibGVUb0FycmF5KGFycikgfHwgX3Vuc3VwcG9ydGVkSXRlcmFibGVUb0FycmF5KGFycikgfHwgX25vbkl0ZXJhYmxlU3ByZWFkKCk7IH1cblxuZnVuY3Rpb24gX25vbkl0ZXJhYmxlU3ByZWFkKCkgeyB0aHJvdyBuZXcgVHlwZUVycm9yKFwiSW52YWxpZCBhdHRlbXB0IHRvIHNwcmVhZCBub24taXRlcmFibGUgaW5zdGFuY2UuXFxuSW4gb3JkZXIgdG8gYmUgaXRlcmFibGUsIG5vbi1hcnJheSBvYmplY3RzIG11c3QgaGF2ZSBhIFtTeW1ib2wuaXRlcmF0b3JdKCkgbWV0aG9kLlwiKTsgfVxuXG5mdW5jdGlvbiBfdW5zdXBwb3J0ZWRJdGVyYWJsZVRvQXJyYXkobywgbWluTGVuKSB7IGlmICghbykgcmV0dXJuOyBpZiAodHlwZW9mIG8gPT09IFwic3RyaW5nXCIpIHJldHVybiBfYXJyYXlMaWtlVG9BcnJheShvLCBtaW5MZW4pOyB2YXIgbiA9IE9iamVjdC5wcm90b3R5cGUudG9TdHJpbmcuY2FsbChvKS5zbGljZSg4LCAtMSk7IGlmIChuID09PSBcIk9iamVjdFwiICYmIG8uY29uc3RydWN0b3IpIG4gPSBvLmNvbnN0cnVjdG9yLm5hbWU7IGlmIChuID09PSBcIk1hcFwiIHx8IG4gPT09IFwiU2V0XCIpIHJldHVybiBBcnJheS5mcm9tKG8pOyBpZiAobiA9PT0gXCJBcmd1bWVudHNcIiB8fCAvXig/OlVpfEkpbnQoPzo4fDE2fDMyKSg/OkNsYW1wZWQpP0FycmF5JC8udGVzdChuKSkgcmV0dXJuIF9hcnJheUxpa2VUb0FycmF5KG8sIG1pbkxlbik7IH1cblxuZnVuY3Rpb24gX2l0ZXJhYmxlVG9BcnJheShpdGVyKSB7IGlmICh0eXBlb2YgU3ltYm9sICE9PSBcInVuZGVmaW5lZFwiICYmIGl0ZXJbU3ltYm9sLml0ZXJhdG9yXSAhPSBudWxsIHx8IGl0ZXJbXCJAQGl0ZXJhdG9yXCJdICE9IG51bGwpIHJldHVybiBBcnJheS5mcm9tKGl0ZXIpOyB9XG5cbmZ1bmN0aW9uIF9hcnJheVdpdGhvdXRIb2xlcyhhcnIpIHsgaWYgKEFycmF5LmlzQXJyYXkoYXJyKSkgcmV0dXJuIF9hcnJheUxpa2VUb0FycmF5KGFycik7IH1cblxuZnVuY3Rpb24gX2FycmF5TGlrZVRvQXJyYXkoYXJyLCBsZW4pIHsgaWYgKGxlbiA9PSBudWxsIHx8IGxlbiA+IGFyci5sZW5ndGgpIGxlbiA9IGFyci5sZW5ndGg7IGZvciAodmFyIGkgPSAwLCBhcnIyID0gbmV3IEFycmF5KGxlbik7IGkgPCBsZW47IGkrKykgeyBhcnIyW2ldID0gYXJyW2ldOyB9IHJldHVybiBhcnIyOyB9XG5cbmZ1bmN0aW9uIF9kZWZpbmVQcm9wZXJ0aWVzKHRhcmdldCwgcHJvcHMpIHsgZm9yICh2YXIgaSA9IDA7IGkgPCBwcm9wcy5sZW5ndGg7IGkrKykgeyB2YXIgZGVzY3JpcHRvciA9IHByb3BzW2ldOyBkZXNjcmlwdG9yLmVudW1lcmFibGUgPSBkZXNjcmlwdG9yLmVudW1lcmFibGUgfHwgZmFsc2U7IGRlc2NyaXB0b3IuY29uZmlndXJhYmxlID0gdHJ1ZTsgaWYgKFwidmFsdWVcIiBpbiBkZXNjcmlwdG9yKSBkZXNjcmlwdG9yLndyaXRhYmxlID0gdHJ1ZTsgT2JqZWN0LmRlZmluZVByb3BlcnR5KHRhcmdldCwgZGVzY3JpcHRvci5rZXksIGRlc2NyaXB0b3IpOyB9IH1cblxuZnVuY3Rpb24gX2NyZWF0ZUNsYXNzKENvbnN0cnVjdG9yLCBwcm90b1Byb3BzLCBzdGF0aWNQcm9wcykgeyBpZiAocHJvdG9Qcm9wcykgX2RlZmluZVByb3BlcnRpZXMoQ29uc3RydWN0b3IucHJvdG90eXBlLCBwcm90b1Byb3BzKTsgaWYgKHN0YXRpY1Byb3BzKSBfZGVmaW5lUHJvcGVydGllcyhDb25zdHJ1Y3Rvciwgc3RhdGljUHJvcHMpOyBPYmplY3QuZGVmaW5lUHJvcGVydHkoQ29uc3RydWN0b3IsIFwicHJvdG90eXBlXCIsIHsgd3JpdGFibGU6IGZhbHNlIH0pOyByZXR1cm4gQ29uc3RydWN0b3I7IH1cblxuZnVuY3Rpb24gX2NsYXNzQ2FsbENoZWNrKGluc3RhbmNlLCBDb25zdHJ1Y3RvcikgeyBpZiAoIShpbnN0YW5jZSBpbnN0YW5jZW9mIENvbnN0cnVjdG9yKSkgeyB0aHJvdyBuZXcgVHlwZUVycm9yKFwiQ2Fubm90IGNhbGwgYSBjbGFzcyBhcyBhIGZ1bmN0aW9uXCIpOyB9IH1cblxuZnVuY3Rpb24gX2luaGVyaXRzKHN1YkNsYXNzLCBzdXBlckNsYXNzKSB7IGlmICh0eXBlb2Ygc3VwZXJDbGFzcyAhPT0gXCJmdW5jdGlvblwiICYmIHN1cGVyQ2xhc3MgIT09IG51bGwpIHsgdGhyb3cgbmV3IFR5cGVFcnJvcihcIlN1cGVyIGV4cHJlc3Npb24gbXVzdCBlaXRoZXIgYmUgbnVsbCBvciBhIGZ1bmN0aW9uXCIpOyB9IHN1YkNsYXNzLnByb3RvdHlwZSA9IE9iamVjdC5jcmVhdGUoc3VwZXJDbGFzcyAmJiBzdXBlckNsYXNzLnByb3RvdHlwZSwgeyBjb25zdHJ1Y3RvcjogeyB2YWx1ZTogc3ViQ2xhc3MsIHdyaXRhYmxlOiB0cnVlLCBjb25maWd1cmFibGU6IHRydWUgfSB9KTsgT2JqZWN0LmRlZmluZVByb3BlcnR5KHN1YkNsYXNzLCBcInByb3RvdHlwZVwiLCB7IHdyaXRhYmxlOiBmYWxzZSB9KTsgaWYgKHN1cGVyQ2xhc3MpIF9zZXRQcm90b3R5cGVPZihzdWJDbGFzcywgc3VwZXJDbGFzcyk7IH1cblxuZnVuY3Rpb24gX2NyZWF0ZVN1cGVyKERlcml2ZWQpIHsgdmFyIGhhc05hdGl2ZVJlZmxlY3RDb25zdHJ1Y3QgPSBfaXNOYXRpdmVSZWZsZWN0Q29uc3RydWN0KCk7IHJldHVybiBmdW5jdGlvbiBfY3JlYXRlU3VwZXJJbnRlcm5hbCgpIHsgdmFyIFN1cGVyID0gX2dldFByb3RvdHlwZU9mKERlcml2ZWQpLCByZXN1bHQ7IGlmIChoYXNOYXRpdmVSZWZsZWN0Q29uc3RydWN0KSB7IHZhciBOZXdUYXJnZXQgPSBfZ2V0UHJvdG90eXBlT2YodGhpcykuY29uc3RydWN0b3I7IHJlc3VsdCA9IFJlZmxlY3QuY29uc3RydWN0KFN1cGVyLCBhcmd1bWVudHMsIE5ld1RhcmdldCk7IH0gZWxzZSB7IHJlc3VsdCA9IFN1cGVyLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7IH0gcmV0dXJuIF9wb3NzaWJsZUNvbnN0cnVjdG9yUmV0dXJuKHRoaXMsIHJlc3VsdCk7IH07IH1cblxuZnVuY3Rpb24gX3Bvc3NpYmxlQ29uc3RydWN0b3JSZXR1cm4oc2VsZiwgY2FsbCkgeyBpZiAoY2FsbCAmJiAoX3R5cGVvZihjYWxsKSA9PT0gXCJvYmplY3RcIiB8fCB0eXBlb2YgY2FsbCA9PT0gXCJmdW5jdGlvblwiKSkgeyByZXR1cm4gY2FsbDsgfSBlbHNlIGlmIChjYWxsICE9PSB2b2lkIDApIHsgdGhyb3cgbmV3IFR5cGVFcnJvcihcIkRlcml2ZWQgY29uc3RydWN0b3JzIG1heSBvbmx5IHJldHVybiBvYmplY3Qgb3IgdW5kZWZpbmVkXCIpOyB9IHJldHVybiBfYXNzZXJ0VGhpc0luaXRpYWxpemVkKHNlbGYpOyB9XG5cbmZ1bmN0aW9uIF9hc3NlcnRUaGlzSW5pdGlhbGl6ZWQoc2VsZikgeyBpZiAoc2VsZiA9PT0gdm9pZCAwKSB7IHRocm93IG5ldyBSZWZlcmVuY2VFcnJvcihcInRoaXMgaGFzbid0IGJlZW4gaW5pdGlhbGlzZWQgLSBzdXBlcigpIGhhc24ndCBiZWVuIGNhbGxlZFwiKTsgfSByZXR1cm4gc2VsZjsgfVxuXG5mdW5jdGlvbiBfd3JhcE5hdGl2ZVN1cGVyKENsYXNzKSB7IHZhciBfY2FjaGUgPSB0eXBlb2YgTWFwID09PSBcImZ1bmN0aW9uXCIgPyBuZXcgTWFwKCkgOiB1bmRlZmluZWQ7IF93cmFwTmF0aXZlU3VwZXIgPSBmdW5jdGlvbiBfd3JhcE5hdGl2ZVN1cGVyKENsYXNzKSB7IGlmIChDbGFzcyA9PT0gbnVsbCB8fCAhX2lzTmF0aXZlRnVuY3Rpb24oQ2xhc3MpKSByZXR1cm4gQ2xhc3M7IGlmICh0eXBlb2YgQ2xhc3MgIT09IFwiZnVuY3Rpb25cIikgeyB0aHJvdyBuZXcgVHlwZUVycm9yKFwiU3VwZXIgZXhwcmVzc2lvbiBtdXN0IGVpdGhlciBiZSBudWxsIG9yIGEgZnVuY3Rpb25cIik7IH0gaWYgKHR5cGVvZiBfY2FjaGUgIT09IFwidW5kZWZpbmVkXCIpIHsgaWYgKF9jYWNoZS5oYXMoQ2xhc3MpKSByZXR1cm4gX2NhY2hlLmdldChDbGFzcyk7IF9jYWNoZS5zZXQoQ2xhc3MsIFdyYXBwZXIpOyB9IGZ1bmN0aW9uIFdyYXBwZXIoKSB7IHJldHVybiBfY29uc3RydWN0KENsYXNzLCBhcmd1bWVudHMsIF9nZXRQcm90b3R5cGVPZih0aGlzKS5jb25zdHJ1Y3Rvcik7IH0gV3JhcHBlci5wcm90b3R5cGUgPSBPYmplY3QuY3JlYXRlKENsYXNzLnByb3RvdHlwZSwgeyBjb25zdHJ1Y3RvcjogeyB2YWx1ZTogV3JhcHBlciwgZW51bWVyYWJsZTogZmFsc2UsIHdyaXRhYmxlOiB0cnVlLCBjb25maWd1cmFibGU6IHRydWUgfSB9KTsgcmV0dXJuIF9zZXRQcm90b3R5cGVPZihXcmFwcGVyLCBDbGFzcyk7IH07IHJldHVybiBfd3JhcE5hdGl2ZVN1cGVyKENsYXNzKTsgfVxuXG5mdW5jdGlvbiBfY29uc3RydWN0KFBhcmVudCwgYXJncywgQ2xhc3MpIHsgaWYgKF9pc05hdGl2ZVJlZmxlY3RDb25zdHJ1Y3QoKSkgeyBfY29uc3RydWN0ID0gUmVmbGVjdC5jb25zdHJ1Y3Q7IH0gZWxzZSB7IF9jb25zdHJ1Y3QgPSBmdW5jdGlvbiBfY29uc3RydWN0KFBhcmVudCwgYXJncywgQ2xhc3MpIHsgdmFyIGEgPSBbbnVsbF07IGEucHVzaC5hcHBseShhLCBhcmdzKTsgdmFyIENvbnN0cnVjdG9yID0gRnVuY3Rpb24uYmluZC5hcHBseShQYXJlbnQsIGEpOyB2YXIgaW5zdGFuY2UgPSBuZXcgQ29uc3RydWN0b3IoKTsgaWYgKENsYXNzKSBfc2V0UHJvdG90eXBlT2YoaW5zdGFuY2UsIENsYXNzLnByb3RvdHlwZSk7IHJldHVybiBpbnN0YW5jZTsgfTsgfSByZXR1cm4gX2NvbnN0cnVjdC5hcHBseShudWxsLCBhcmd1bWVudHMpOyB9XG5cbmZ1bmN0aW9uIF9pc05hdGl2ZVJlZmxlY3RDb25zdHJ1Y3QoKSB7IGlmICh0eXBlb2YgUmVmbGVjdCA9PT0gXCJ1bmRlZmluZWRcIiB8fCAhUmVmbGVjdC5jb25zdHJ1Y3QpIHJldHVybiBmYWxzZTsgaWYgKFJlZmxlY3QuY29uc3RydWN0LnNoYW0pIHJldHVybiBmYWxzZTsgaWYgKHR5cGVvZiBQcm94eSA9PT0gXCJmdW5jdGlvblwiKSByZXR1cm4gdHJ1ZTsgdHJ5IHsgQm9vbGVhbi5wcm90b3R5cGUudmFsdWVPZi5jYWxsKFJlZmxlY3QuY29uc3RydWN0KEJvb2xlYW4sIFtdLCBmdW5jdGlvbiAoKSB7fSkpOyByZXR1cm4gdHJ1ZTsgfSBjYXRjaCAoZSkgeyByZXR1cm4gZmFsc2U7IH0gfVxuXG5mdW5jdGlvbiBfaXNOYXRpdmVGdW5jdGlvbihmbikgeyByZXR1cm4gRnVuY3Rpb24udG9TdHJpbmcuY2FsbChmbikuaW5kZXhPZihcIltuYXRpdmUgY29kZV1cIikgIT09IC0xOyB9XG5cbmZ1bmN0aW9uIF9zZXRQcm90b3R5cGVPZihvLCBwKSB7IF9zZXRQcm90b3R5cGVPZiA9IE9iamVjdC5zZXRQcm90b3R5cGVPZiB8fCBmdW5jdGlvbiBfc2V0UHJvdG90eXBlT2YobywgcCkgeyBvLl9fcHJvdG9fXyA9IHA7IHJldHVybiBvOyB9OyByZXR1cm4gX3NldFByb3RvdHlwZU9mKG8sIHApOyB9XG5cbmZ1bmN0aW9uIF9nZXRQcm90b3R5cGVPZihvKSB7IF9nZXRQcm90b3R5cGVPZiA9IE9iamVjdC5zZXRQcm90b3R5cGVPZiA/IE9iamVjdC5nZXRQcm90b3R5cGVPZiA6IGZ1bmN0aW9uIF9nZXRQcm90b3R5cGVPZihvKSB7IHJldHVybiBvLl9fcHJvdG9fXyB8fCBPYmplY3QuZ2V0UHJvdG90eXBlT2Yobyk7IH07IHJldHVybiBfZ2V0UHJvdG90eXBlT2Yobyk7IH1cblxudmFyIEFnZ3JlZ2F0ZWRFcnJvciA9IC8qI19fUFVSRV9fKi9mdW5jdGlvbiAoX0Vycm9yKSB7XG4gIF9pbmhlcml0cyhBZ2dyZWdhdGVkRXJyb3IsIF9FcnJvcik7XG5cbiAgdmFyIF9zdXBlciA9IF9jcmVhdGVTdXBlcihBZ2dyZWdhdGVkRXJyb3IpO1xuXG4gIGZ1bmN0aW9uIEFnZ3JlZ2F0ZWRFcnJvcigpIHtcbiAgICB2YXIgX3RoaXM7XG5cbiAgICB2YXIgZXJyb3JzID0gYXJndW1lbnRzLmxlbmd0aCA+IDAgJiYgYXJndW1lbnRzWzBdICE9PSB1bmRlZmluZWQgPyBhcmd1bWVudHNbMF0gOiBbXTtcbiAgICB2YXIgbWVzc2FnZSA9IGFyZ3VtZW50cy5sZW5ndGggPiAxICYmIGFyZ3VtZW50c1sxXSAhPT0gdW5kZWZpbmVkID8gYXJndW1lbnRzWzFdIDogJyc7XG5cbiAgICBfY2xhc3NDYWxsQ2hlY2sodGhpcywgQWdncmVnYXRlZEVycm9yKTtcblxuICAgIF90aGlzID0gX3N1cGVyLmNhbGwodGhpcywgbWVzc2FnZSk7XG4gICAgX3RoaXMuZXJyb3JzID0gZXJyb3JzO1xuICAgIHJldHVybiBfdGhpcztcbiAgfVxuXG4gIHJldHVybiBfY3JlYXRlQ2xhc3MoQWdncmVnYXRlZEVycm9yKTtcbn0oIC8qI19fUFVSRV9fKi9fd3JhcE5hdGl2ZVN1cGVyKEVycm9yKSk7XG5cbmV4cG9ydHMuQWdncmVnYXRlZEVycm9yID0gQWdncmVnYXRlZEVycm9yO1xuXG52YXIgYW55UG9ueWZpbGwgPSBmdW5jdGlvbiBhbnlQb255ZmlsbChpdGVyYWJsZSkge1xuICB2YXIgZXhjZXB0aW9ucyA9IFtdO1xuICByZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24gKHJlc29sdmUsIHJlamVjdCkge1xuICAgIHZhciBvblJlamVjdCA9IGZ1bmN0aW9uIG9uUmVqZWN0KGUpIHtcbiAgICAgIGV4Y2VwdGlvbnMucHVzaChlKTtcblxuICAgICAgaWYgKGV4Y2VwdGlvbnMubGVuZ3RoID09PSBpdGVyYWJsZS5sZW5ndGgpIHtcbiAgICAgICAgcmVqZWN0KG5ldyBBZ2dyZWdhdGVkRXJyb3IoZXhjZXB0aW9ucykpO1xuICAgICAgfVxuICAgIH07XG5cbiAgICAoMCwgX3JhbWRhLm1hcCkoZnVuY3Rpb24gKHApIHtcbiAgICAgIHJldHVybiAoMCwgX3Jlc29sdmVQW1wiZGVmYXVsdFwiXSkocCkudGhlbihyZXNvbHZlKVtcImNhdGNoXCJdKG9uUmVqZWN0KTtcbiAgICB9LCBfdG9Db25zdW1hYmxlQXJyYXkoaXRlcmFibGUpKTtcbiAgfSk7XG59O1xuXG52YXIgX2RlZmF1bHQgPSBhbnlQb255ZmlsbDtcbmV4cG9ydHNbXCJkZWZhdWx0XCJdID0gX2RlZmF1bHQ7Il19