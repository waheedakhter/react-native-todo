d8a73c8183a414172b32b8510a7e65d9
"use strict";

var _interopRequireDefault = require("@babel/runtime/helpers/interopRequireDefault");

var _toConsumableArray2 = _interopRequireDefault(require("@babel/runtime/helpers/toConsumableArray"));

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.default = checkSerializable;

var checkSerializableWithoutCircularReference = function checkSerializableWithoutCircularReference(o, seen, location) {
  if (o === undefined || o === null || typeof o === 'boolean' || typeof o === 'number' || typeof o === 'string') {
    return {
      serializable: true
    };
  }

  if (Object.prototype.toString.call(o) !== '[object Object]' && !Array.isArray(o)) {
    return {
      serializable: false,
      location: location,
      reason: typeof o === 'function' ? 'Function' : String(o)
    };
  }

  if (seen.has(o)) {
    return {
      serializable: false,
      reason: 'Circular reference',
      location: location
    };
  }

  seen.add(o);

  if (Array.isArray(o)) {
    for (var i = 0; i < o.length; i++) {
      var childResult = checkSerializableWithoutCircularReference(o[i], new Set(seen), [].concat((0, _toConsumableArray2.default)(location), [i]));

      if (!childResult.serializable) {
        return childResult;
      }
    }
  } else {
    for (var key in o) {
      var _childResult = checkSerializableWithoutCircularReference(o[key], new Set(seen), [].concat((0, _toConsumableArray2.default)(location), [key]));

      if (!_childResult.serializable) {
        return _childResult;
      }
    }
  }

  return {
    serializable: true
  };
};

function checkSerializable(o) {
  return checkSerializableWithoutCircularReference(o, new Set(), []);
}
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImNoZWNrU2VyaWFsaXphYmxlLnRzeCJdLCJuYW1lcyI6WyJjaGVja1NlcmlhbGl6YWJsZVdpdGhvdXRDaXJjdWxhclJlZmVyZW5jZSIsIm8iLCJzZXJpYWxpemFibGUiLCJPYmplY3QiLCJBcnJheSIsImxvY2F0aW9uIiwicmVhc29uIiwiU3RyaW5nIiwic2VlbiIsImkiLCJjaGlsZFJlc3VsdCJdLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7Ozs7QUFBQSxJQUFNQSx5Q0FBeUMsR0FBRyxTQUE1Q0EseUNBQTRDLENBQUEsQ0FBQSxFQUFBLElBQUEsRUFBQSxRQUFBLEVBVXpDO0FBQ1AsTUFDRUMsQ0FBQyxLQUFEQSxTQUFBQSxJQUNBQSxDQUFDLEtBRERBLElBQUFBLElBRUEsT0FBQSxDQUFBLEtBRkFBLFNBQUFBLElBR0EsT0FBQSxDQUFBLEtBSEFBLFFBQUFBLElBSUEsT0FBQSxDQUFBLEtBTEYsUUFBQSxFQU1FO0FBQ0EsV0FBTztBQUFFQyxNQUFBQSxZQUFZLEVBQUU7QUFBaEIsS0FBUDtBQUNEOztBQUVELE1BQ0VDLE1BQU0sQ0FBTkEsU0FBQUEsQ0FBQUEsUUFBQUEsQ0FBQUEsSUFBQUEsQ0FBQUEsQ0FBQUEsTUFBQUEsaUJBQUFBLElBQ0EsQ0FBQ0MsS0FBSyxDQUFMQSxPQUFBQSxDQUZILENBRUdBLENBRkgsRUFHRTtBQUNBLFdBQU87QUFDTEYsTUFBQUEsWUFBWSxFQURQLEtBQUE7QUFFTEcsTUFBQUEsUUFGSyxFQUVMQSxRQUZLO0FBR0xDLE1BQUFBLE1BQU0sRUFBRSxPQUFBLENBQUEsS0FBQSxVQUFBLEdBQUEsVUFBQSxHQUF1Q0MsTUFBTSxDQUFBLENBQUE7QUFIaEQsS0FBUDtBQUtEOztBQUVELE1BQUlDLElBQUksQ0FBSkEsR0FBQUEsQ0FBSixDQUFJQSxDQUFKLEVBQWlCO0FBQ2YsV0FBTztBQUNMTixNQUFBQSxZQUFZLEVBRFAsS0FBQTtBQUVMSSxNQUFBQSxNQUFNLEVBRkQsb0JBQUE7QUFHTEQsTUFBQUEsUUFBQUEsRUFBQUE7QUFISyxLQUFQO0FBS0Q7O0FBRURHLEVBQUFBLElBQUksQ0FBSkEsR0FBQUEsQ0FBQUEsQ0FBQUE7O0FBRUEsTUFBSUosS0FBSyxDQUFMQSxPQUFBQSxDQUFKLENBQUlBLENBQUosRUFBc0I7QUFDcEIsU0FBSyxJQUFJSyxDQUFDLEdBQVYsQ0FBQSxFQUFnQkEsQ0FBQyxHQUFHUixDQUFDLENBQXJCLE1BQUEsRUFBOEJRLENBQTlCLEVBQUEsRUFBbUM7QUFDakMsVUFBTUMsV0FBVyxHQUFHVix5Q0FBeUMsQ0FDM0RDLENBQUMsQ0FEMEQsQ0FDMUQsQ0FEMEQsRUFFM0QsSUFBQSxHQUFBLENBRjJELElBRTNELENBRjJELDZDQUczRCxRQUgyRCxJQUE3RCxDQUE2RCxHQUE3RDs7QUFNQSxVQUFJLENBQUNTLFdBQVcsQ0FBaEIsWUFBQSxFQUErQjtBQUM3QixlQUFBLFdBQUE7QUFDRDtBQUNGO0FBWEgsR0FBQSxNQVlPO0FBQ0wsU0FBSyxJQUFMLEdBQUEsSUFBQSxDQUFBLEVBQXFCO0FBQ25CLFVBQU1BLFlBQVcsR0FBR1YseUNBQXlDLENBQzNEQyxDQUFDLENBRDBELEdBQzFELENBRDBELEVBRTNELElBQUEsR0FBQSxDQUYyRCxJQUUzRCxDQUYyRCw2Q0FHM0QsUUFIMkQsSUFBN0QsR0FBNkQsR0FBN0Q7O0FBTUEsVUFBSSxDQUFDUyxZQUFXLENBQWhCLFlBQUEsRUFBK0I7QUFDN0IsZUFBQSxZQUFBO0FBQ0Q7QUFDRjtBQUNGOztBQUVELFNBQU87QUFBRVIsSUFBQUEsWUFBWSxFQUFFO0FBQWhCLEdBQVA7QUFwRUYsQ0FBQTs7QUF1RWUsU0FBQSxpQkFBQSxDQUFBLENBQUEsRUFBc0Q7QUFDbkUsU0FBT0YseUNBQXlDLENBQUEsQ0FBQSxFQUFJLElBQUosR0FBSSxFQUFKLEVBQWhELEVBQWdELENBQWhEO0FBQ0QiLCJzb3VyY2VzQ29udGVudCI6WyJjb25zdCBjaGVja1NlcmlhbGl6YWJsZVdpdGhvdXRDaXJjdWxhclJlZmVyZW5jZSA9IChcbiAgbzogeyBba2V5OiBzdHJpbmddOiBhbnkgfSxcbiAgc2VlbjogU2V0PGFueT4sXG4gIGxvY2F0aW9uOiAoc3RyaW5nIHwgbnVtYmVyKVtdXG4pOlxuICB8IHsgc2VyaWFsaXphYmxlOiB0cnVlIH1cbiAgfCB7XG4gICAgICBzZXJpYWxpemFibGU6IGZhbHNlO1xuICAgICAgbG9jYXRpb246IChzdHJpbmcgfCBudW1iZXIpW107XG4gICAgICByZWFzb246IHN0cmluZztcbiAgICB9ID0+IHtcbiAgaWYgKFxuICAgIG8gPT09IHVuZGVmaW5lZCB8fFxuICAgIG8gPT09IG51bGwgfHxcbiAgICB0eXBlb2YgbyA9PT0gJ2Jvb2xlYW4nIHx8XG4gICAgdHlwZW9mIG8gPT09ICdudW1iZXInIHx8XG4gICAgdHlwZW9mIG8gPT09ICdzdHJpbmcnXG4gICkge1xuICAgIHJldHVybiB7IHNlcmlhbGl6YWJsZTogdHJ1ZSB9O1xuICB9XG5cbiAgaWYgKFxuICAgIE9iamVjdC5wcm90b3R5cGUudG9TdHJpbmcuY2FsbChvKSAhPT0gJ1tvYmplY3QgT2JqZWN0XScgJiZcbiAgICAhQXJyYXkuaXNBcnJheShvKVxuICApIHtcbiAgICByZXR1cm4ge1xuICAgICAgc2VyaWFsaXphYmxlOiBmYWxzZSxcbiAgICAgIGxvY2F0aW9uLFxuICAgICAgcmVhc29uOiB0eXBlb2YgbyA9PT0gJ2Z1bmN0aW9uJyA/ICdGdW5jdGlvbicgOiBTdHJpbmcobyksXG4gICAgfTtcbiAgfVxuXG4gIGlmIChzZWVuLmhhcyhvKSkge1xuICAgIHJldHVybiB7XG4gICAgICBzZXJpYWxpemFibGU6IGZhbHNlLFxuICAgICAgcmVhc29uOiAnQ2lyY3VsYXIgcmVmZXJlbmNlJyxcbiAgICAgIGxvY2F0aW9uLFxuICAgIH07XG4gIH1cblxuICBzZWVuLmFkZChvKTtcblxuICBpZiAoQXJyYXkuaXNBcnJheShvKSkge1xuICAgIGZvciAobGV0IGkgPSAwOyBpIDwgby5sZW5ndGg7IGkrKykge1xuICAgICAgY29uc3QgY2hpbGRSZXN1bHQgPSBjaGVja1NlcmlhbGl6YWJsZVdpdGhvdXRDaXJjdWxhclJlZmVyZW5jZShcbiAgICAgICAgb1tpXSxcbiAgICAgICAgbmV3IFNldDxhbnk+KHNlZW4pLFxuICAgICAgICBbLi4ubG9jYXRpb24sIGldXG4gICAgICApO1xuXG4gICAgICBpZiAoIWNoaWxkUmVzdWx0LnNlcmlhbGl6YWJsZSkge1xuICAgICAgICByZXR1cm4gY2hpbGRSZXN1bHQ7XG4gICAgICB9XG4gICAgfVxuICB9IGVsc2Uge1xuICAgIGZvciAoY29uc3Qga2V5IGluIG8pIHtcbiAgICAgIGNvbnN0IGNoaWxkUmVzdWx0ID0gY2hlY2tTZXJpYWxpemFibGVXaXRob3V0Q2lyY3VsYXJSZWZlcmVuY2UoXG4gICAgICAgIG9ba2V5XSxcbiAgICAgICAgbmV3IFNldDxhbnk+KHNlZW4pLFxuICAgICAgICBbLi4ubG9jYXRpb24sIGtleV1cbiAgICAgICk7XG5cbiAgICAgIGlmICghY2hpbGRSZXN1bHQuc2VyaWFsaXphYmxlKSB7XG4gICAgICAgIHJldHVybiBjaGlsZFJlc3VsdDtcbiAgICAgIH1cbiAgICB9XG4gIH1cblxuICByZXR1cm4geyBzZXJpYWxpemFibGU6IHRydWUgfTtcbn07XG5cbmV4cG9ydCBkZWZhdWx0IGZ1bmN0aW9uIGNoZWNrU2VyaWFsaXphYmxlKG86IHsgW2tleTogc3RyaW5nXTogYW55IH0pIHtcbiAgcmV0dXJuIGNoZWNrU2VyaWFsaXphYmxlV2l0aG91dENpcmN1bGFyUmVmZXJlbmNlKG8sIG5ldyBTZXQ8YW55PigpLCBbXSk7XG59XG4iXX0=