56aea9541af7c442242520783fc3c186
"use strict";

exports.__esModule = true;
exports["default"] = void 0;

var _ramda = require("ramda");

var _isUndefined = _interopRequireDefault(require("./isUndefined"));

var _resolveP = _interopRequireDefault(require("./resolveP"));

var _allP = _interopRequireDefault(require("./allP"));

function _interopRequireDefault(obj) {
  return obj && obj.__esModule ? obj : {
    "default": obj
  };
}

function _slicedToArray(arr, i) {
  return _arrayWithHoles(arr) || _iterableToArrayLimit(arr, i) || _unsupportedIterableToArray(arr, i) || _nonIterableRest();
}

function _nonIterableRest() {
  throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.");
}

function _unsupportedIterableToArray(o, minLen) {
  if (!o) return;
  if (typeof o === "string") return _arrayLikeToArray(o, minLen);
  var n = Object.prototype.toString.call(o).slice(8, -1);
  if (n === "Object" && o.constructor) n = o.constructor.name;
  if (n === "Map" || n === "Set") return Array.from(o);
  if (n === "Arguments" || /^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)) return _arrayLikeToArray(o, minLen);
}

function _arrayLikeToArray(arr, len) {
  if (len == null || len > arr.length) len = arr.length;

  for (var i = 0, arr2 = new Array(len); i < len; i++) {
    arr2[i] = arr[i];
  }

  return arr2;
}

function _iterableToArrayLimit(arr, i) {
  var _i = arr == null ? null : typeof Symbol !== "undefined" && arr[Symbol.iterator] || arr["@@iterator"];

  if (_i == null) return;
  var _arr = [];
  var _n = true;
  var _d = false;

  var _s, _e;

  try {
    for (_i = _i.call(arr); !(_n = (_s = _i.next()).done); _n = true) {
      _arr.push(_s.value);

      if (i && _arr.length === i) break;
    }
  } catch (err) {
    _d = true;
    _e = err;
  } finally {
    try {
      if (!_n && _i["return"] != null) _i["return"]();
    } finally {
      if (_d) throw _e;
    }
  }

  return _arr;
}

function _arrayWithHoles(arr) {
  if (Array.isArray(arr)) return arr;
}

var reduceP = (0, _ramda.curryN)(3, function (fn, acc, list) {
  return (0, _resolveP["default"])(list).then(function (iterable) {
    var listLength = (0, _ramda.length)(iterable);

    if (listLength === 0) {
      return acc;
    }

    var reducer = (0, _ramda.reduce)(function (accP, currentValueP) {
      return accP.then(function (previousValue) {
        return (0, _allP["default"])([previousValue, currentValueP]);
      }).then(function (_ref) {
        var _ref2 = _slicedToArray(_ref, 2),
            previousValue = _ref2[0],
            currentValue = _ref2[1];

        if ((0, _isUndefined["default"])(previousValue) && listLength === 1) {
          return currentValue;
        }

        return fn(previousValue, currentValue);
      });
    });
    return reducer((0, _resolveP["default"])(acc), iterable);
  });
});
var _default = reduceP;
exports["default"] = _default;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInJlZHVjZVAuanMiXSwibmFtZXMiOlsiZXhwb3J0cyIsIl9fZXNNb2R1bGUiLCJfcmFtZGEiLCJyZXF1aXJlIiwiX2lzVW5kZWZpbmVkIiwiX2ludGVyb3BSZXF1aXJlRGVmYXVsdCIsIl9yZXNvbHZlUCIsIl9hbGxQIiwib2JqIiwiX3NsaWNlZFRvQXJyYXkiLCJhcnIiLCJpIiwiX2FycmF5V2l0aEhvbGVzIiwiX2l0ZXJhYmxlVG9BcnJheUxpbWl0IiwiX3Vuc3VwcG9ydGVkSXRlcmFibGVUb0FycmF5IiwiX25vbkl0ZXJhYmxlUmVzdCIsIlR5cGVFcnJvciIsIm8iLCJtaW5MZW4iLCJfYXJyYXlMaWtlVG9BcnJheSIsIm4iLCJPYmplY3QiLCJwcm90b3R5cGUiLCJ0b1N0cmluZyIsImNhbGwiLCJzbGljZSIsImNvbnN0cnVjdG9yIiwibmFtZSIsIkFycmF5IiwiZnJvbSIsInRlc3QiLCJsZW4iLCJsZW5ndGgiLCJhcnIyIiwiX2kiLCJTeW1ib2wiLCJpdGVyYXRvciIsIl9hcnIiLCJfbiIsIl9kIiwiX3MiLCJfZSIsIm5leHQiLCJkb25lIiwicHVzaCIsInZhbHVlIiwiZXJyIiwiaXNBcnJheSIsInJlZHVjZVAiLCJjdXJyeU4iLCJmbiIsImFjYyIsImxpc3QiLCJ0aGVuIiwiaXRlcmFibGUiLCJsaXN0TGVuZ3RoIiwicmVkdWNlciIsInJlZHVjZSIsImFjY1AiLCJjdXJyZW50VmFsdWVQIiwicHJldmlvdXNWYWx1ZSIsIl9yZWYiLCJfcmVmMiIsImN1cnJlbnRWYWx1ZSIsIl9kZWZhdWx0Il0sIm1hcHBpbmdzIjoiQUFBQTs7QUFFQUEsT0FBTyxDQUFDQyxVQUFSLEdBQXFCLElBQXJCO0FBQ0FELE9BQU8sQ0FBQyxTQUFELENBQVAsR0FBcUIsS0FBSyxDQUExQjs7QUFFQSxJQUFJRSxNQUFNLEdBQUdDLE9BQU8sQ0FBQyxPQUFELENBQXBCOztBQUVBLElBQUlDLFlBQVksR0FBR0Msc0JBQXNCLENBQUNGLE9BQU8sQ0FBQyxlQUFELENBQVIsQ0FBekM7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QUFxQmdFLFFBQXJCIiwic291cmNlc0NvbnRlbnQiOlsiXCJ1c2Ugc3RyaWN0XCI7XG5cbmV4cG9ydHMuX19lc01vZHVsZSA9IHRydWU7XG5leHBvcnRzW1wiZGVmYXVsdFwiXSA9IHZvaWQgMDtcblxudmFyIF9yYW1kYSA9IHJlcXVpcmUoXCJyYW1kYVwiKTtcblxudmFyIF9pc1VuZGVmaW5lZCA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQocmVxdWlyZShcIi4vaXNVbmRlZmluZWRcIikpO1xuXG52YXIgX3Jlc29sdmVQID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChyZXF1aXJlKFwiLi9yZXNvbHZlUFwiKSk7XG5cbnZhciBfYWxsUCA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQocmVxdWlyZShcIi4vYWxsUFwiKSk7XG5cbmZ1bmN0aW9uIF9pbnRlcm9wUmVxdWlyZURlZmF1bHQob2JqKSB7IHJldHVybiBvYmogJiYgb2JqLl9fZXNNb2R1bGUgPyBvYmogOiB7IFwiZGVmYXVsdFwiOiBvYmogfTsgfVxuXG5mdW5jdGlvbiBfc2xpY2VkVG9BcnJheShhcnIsIGkpIHsgcmV0dXJuIF9hcnJheVdpdGhIb2xlcyhhcnIpIHx8IF9pdGVyYWJsZVRvQXJyYXlMaW1pdChhcnIsIGkpIHx8IF91bnN1cHBvcnRlZEl0ZXJhYmxlVG9BcnJheShhcnIsIGkpIHx8IF9ub25JdGVyYWJsZVJlc3QoKTsgfVxuXG5mdW5jdGlvbiBfbm9uSXRlcmFibGVSZXN0KCkgeyB0aHJvdyBuZXcgVHlwZUVycm9yKFwiSW52YWxpZCBhdHRlbXB0IHRvIGRlc3RydWN0dXJlIG5vbi1pdGVyYWJsZSBpbnN0YW5jZS5cXG5JbiBvcmRlciB0byBiZSBpdGVyYWJsZSwgbm9uLWFycmF5IG9iamVjdHMgbXVzdCBoYXZlIGEgW1N5bWJvbC5pdGVyYXRvcl0oKSBtZXRob2QuXCIpOyB9XG5cbmZ1bmN0aW9uIF91bnN1cHBvcnRlZEl0ZXJhYmxlVG9BcnJheShvLCBtaW5MZW4pIHsgaWYgKCFvKSByZXR1cm47IGlmICh0eXBlb2YgbyA9PT0gXCJzdHJpbmdcIikgcmV0dXJuIF9hcnJheUxpa2VUb0FycmF5KG8sIG1pbkxlbik7IHZhciBuID0gT2JqZWN0LnByb3RvdHlwZS50b1N0cmluZy5jYWxsKG8pLnNsaWNlKDgsIC0xKTsgaWYgKG4gPT09IFwiT2JqZWN0XCIgJiYgby5jb25zdHJ1Y3RvcikgbiA9IG8uY29uc3RydWN0b3IubmFtZTsgaWYgKG4gPT09IFwiTWFwXCIgfHwgbiA9PT0gXCJTZXRcIikgcmV0dXJuIEFycmF5LmZyb20obyk7IGlmIChuID09PSBcIkFyZ3VtZW50c1wiIHx8IC9eKD86VWl8SSludCg/Ojh8MTZ8MzIpKD86Q2xhbXBlZCk/QXJyYXkkLy50ZXN0KG4pKSByZXR1cm4gX2FycmF5TGlrZVRvQXJyYXkobywgbWluTGVuKTsgfVxuXG5mdW5jdGlvbiBfYXJyYXlMaWtlVG9BcnJheShhcnIsIGxlbikgeyBpZiAobGVuID09IG51bGwgfHwgbGVuID4gYXJyLmxlbmd0aCkgbGVuID0gYXJyLmxlbmd0aDsgZm9yICh2YXIgaSA9IDAsIGFycjIgPSBuZXcgQXJyYXkobGVuKTsgaSA8IGxlbjsgaSsrKSB7IGFycjJbaV0gPSBhcnJbaV07IH0gcmV0dXJuIGFycjI7IH1cblxuZnVuY3Rpb24gX2l0ZXJhYmxlVG9BcnJheUxpbWl0KGFyciwgaSkgeyB2YXIgX2kgPSBhcnIgPT0gbnVsbCA/IG51bGwgOiB0eXBlb2YgU3ltYm9sICE9PSBcInVuZGVmaW5lZFwiICYmIGFycltTeW1ib2wuaXRlcmF0b3JdIHx8IGFycltcIkBAaXRlcmF0b3JcIl07IGlmIChfaSA9PSBudWxsKSByZXR1cm47IHZhciBfYXJyID0gW107IHZhciBfbiA9IHRydWU7IHZhciBfZCA9IGZhbHNlOyB2YXIgX3MsIF9lOyB0cnkgeyBmb3IgKF9pID0gX2kuY2FsbChhcnIpOyAhKF9uID0gKF9zID0gX2kubmV4dCgpKS5kb25lKTsgX24gPSB0cnVlKSB7IF9hcnIucHVzaChfcy52YWx1ZSk7IGlmIChpICYmIF9hcnIubGVuZ3RoID09PSBpKSBicmVhazsgfSB9IGNhdGNoIChlcnIpIHsgX2QgPSB0cnVlOyBfZSA9IGVycjsgfSBmaW5hbGx5IHsgdHJ5IHsgaWYgKCFfbiAmJiBfaVtcInJldHVyblwiXSAhPSBudWxsKSBfaVtcInJldHVyblwiXSgpOyB9IGZpbmFsbHkgeyBpZiAoX2QpIHRocm93IF9lOyB9IH0gcmV0dXJuIF9hcnI7IH1cblxuZnVuY3Rpb24gX2FycmF5V2l0aEhvbGVzKGFycikgeyBpZiAoQXJyYXkuaXNBcnJheShhcnIpKSByZXR1cm4gYXJyOyB9XG5cbi8qIGVzbGludC1kaXNhYmxlIG1heC1sZW4gKi9cblxuLyoqXG4gKiBHaXZlbiBhbiBgSXRlcmFibGVgKGFycmF5cyBhcmUgYEl0ZXJhYmxlYCksIG9yIGEgcHJvbWlzZSBvZiBhbiBgSXRlcmFibGVgLFxuICogd2hpY2ggcHJvZHVjZXMgcHJvbWlzZXMgKG9yIGEgbWl4IG9mIHByb21pc2VzIGFuZCB2YWx1ZXMpLFxuICogaXRlcmF0ZSBvdmVyIGFsbCB0aGUgdmFsdWVzIGluIHRoZSBgSXRlcmFibGVgIGludG8gYW4gYXJyYXkgYW5kXG4gKiByZWR1Y2UgdGhlIGFycmF5IHRvIGEgdmFsdWUgdXNpbmcgdGhlIGdpdmVuIGl0ZXJhdG9yIGZ1bmN0aW9uLlxuICpcbiAqIElmIHRoZSBpdGVyYXRvciBmdW5jdGlvbiByZXR1cm5zIGEgcHJvbWlzZSwgdGhlbiB0aGUgcmVzdWx0IG9mIHRoZSBwcm9taXNlIGlzIGF3YWl0ZWQsXG4gKiBiZWZvcmUgY29udGludWluZyB3aXRoIG5leHQgaXRlcmF0aW9uLiBJZiBhbnkgcHJvbWlzZSBpbiB0aGUgYXJyYXkgaXMgcmVqZWN0ZWQgb3IgYSBwcm9taXNlXG4gKiByZXR1cm5lZCBieSB0aGUgaXRlcmF0b3IgZnVuY3Rpb24gaXMgcmVqZWN0ZWQsIHRoZSByZXN1bHQgaXMgcmVqZWN0ZWQgYXMgd2VsbC5cbiAqXG4gKiBJZiBgaW5pdGlhbFZhbHVlYCBpcyBgdW5kZWZpbmVkYCAob3IgYSBwcm9taXNlIHRoYXQgcmVzb2x2ZXMgdG8gYHVuZGVmaW5lZGApIGFuZFxuICogdGhlIGBJdGVyYWJsZWAgY29udGFpbnMgb25seSAxIGl0ZW0sIHRoZSBjYWxsYmFjayB3aWxsIG5vdCBiZSBjYWxsZWQgYW5kXG4gKiB0aGUgYEl0ZXJhYmxlJ3NgIHNpbmdsZSBpdGVtIGlzIHJldHVybmVkLiBJZiB0aGUgYEl0ZXJhYmxlYCBpcyBlbXB0eSwgdGhlIGNhbGxiYWNrXG4gKiB3aWxsIG5vdCBiZSBjYWxsZWQgYW5kIGBpbml0aWFsVmFsdWVgIGlzIHJldHVybmVkICh3aGljaCBtYXkgYmUgdW5kZWZpbmVkKS5cbiAqXG4gKiBUaGlzIGZ1bmN0aW9uIGlzIGJhc2ljYWxseSBlcXVpdmFsZW50IHRvIHtAbGluayBodHRwOi8vYmx1ZWJpcmRqcy5jb20vZG9jcy9hcGkvcHJvbWlzZS5yZWR1Y2UuaHRtbHxibHVlYmlyZC5yZWR1Y2V9LlxuICpcbiAqIEBmdW5jIHJlZHVjZVBcbiAqIEBtZW1iZXJPZiBSQVxuICogQHNpbmNlIHtAbGluayBodHRwczovL2NoYXIwbi5naXRodWIuaW8vcmFtZGEtYWRqdW5jdC8xLjEzLjB8djEuMTMuMH1cbiAqIEBjYXRlZ29yeSBMaXN0XG4gKiBAdHlwZWRlZiBNYXliZVByb21pc2UgPSBQcm9taXNlLjwqPiB8ICpcbiAqIEBzaWcgKChQcm9taXNlIGEsIE1heWJlUHJvbWlzZSBiKSAtPiBQcm9taXNlIGEpIC0+IE1heWJlUHJvbWlzZSBhIC0+IE1heWJlUHJvbWlzZSBbTWF5YmVQcm9taXNlIGJdIC0+IFByb21pc2UgYVxuICogQHBhcmFtIHtGdW5jdGlvbn0gZm4gVGhlIGl0ZXJhdG9yIGZ1bmN0aW9uLiBSZWNlaXZlcyB0d28gdmFsdWVzLCB0aGUgYWNjdW11bGF0b3IgYW5kIHRoZSBjdXJyZW50IGVsZW1lbnQgZnJvbSB0aGUgbGlzdFxuICogQHBhcmFtIHsqfFByb21pc2UuPCo+fSBhY2MgVGhlIGFjY3VtdWxhdG9yIHZhbHVlXG4gKiBAcGFyYW0ge0FycmF5LjwqPnxQcm9taXNlLjxBcnJheTwqfFByb21pc2UuPCo+Pj59IGxpc3QgVGhlIGxpc3QgdG8gaXRlcmF0ZSBvdmVyXG4gKiBAcmV0dXJuIHtQcm9taXNlfSBUaGUgZmluYWwsIGFjY3VtdWxhdGVkIHZhbHVlXG4gKiBAc2VlIHtAbGluayBodHRwOi8vcmFtZGFqcy5jb20vZG9jcy8jcmVkdWNlfFIucmVkdWNlfSwge0BsaW5rIFJBLnJlZHVjZVJpZ2h0UHxyZWR1Y2VSaWdodFB9LCB7QGxpbmsgaHR0cDovL2JsdWViaXJkanMuY29tL2RvY3MvYXBpL3Byb21pc2UucmVkdWNlLmh0bWx8Ymx1ZWJpcmQucmVkdWNlfVxuICogQGV4YW1wbGVcbiAqXG4gKiBSQS5yZWR1Y2VQKFxuICogICAodG90YWwsIGZpbGVOYW1lKSA9PiBmc1xuICogICAgIC5yZWFkRmlsZUFzeW5jKGZpbGVOYW1lLCAndXRmOCcpXG4gKiAgICAgLnRoZW4oY29udGVudHMgPT4gdG90YWwgKyBwYXJzZUludChjb250ZW50cywgMTApKSxcbiAqICAgMCxcbiAqICAgWydmaWxlMS50eHQnLCAnZmlsZTIudHh0JywgJ2ZpbGUzLnR4dCddXG4gKiApOyAvLyA9PiBQcm9taXNlKDEwKVxuICpcbiAqIFJBLnJlZHVjZVAoXG4gKiAgICh0b3RhbCwgZmlsZU5hbWUpID0+IGZzXG4gKiAgICAgLnJlYWRGaWxlQXN5bmMoZmlsZU5hbWUsICd1dGY4JylcbiAqICAgICAudGhlbihjb250ZW50cyA9PiB0b3RhbCArIHBhcnNlSW50KGNvbnRlbnRzLCAxMCkpLFxuICogICBQcm9taXNlLnJlc29sdmUoMCksXG4gKiAgIFsnZmlsZTEudHh0JywgJ2ZpbGUyLnR4dCcsICdmaWxlMy50eHQnXVxuICogKTsgLy8gPT4gUHJvbWlzZSgxMClcbiAqXG4gKiBSQS5yZWR1Y2VQKFxuICogICAodG90YWwsIGZpbGVOYW1lKSA9PiBmc1xuICogICAgIC5yZWFkRmlsZUFzeW5jKGZpbGVOYW1lLCAndXRmOCcpXG4gKiAgICAgLnRoZW4oY29udGVudHMgPT4gdG90YWwgKyBwYXJzZUludChjb250ZW50cywgMTApKSxcbiAqICAgMCxcbiAqICAgW1Byb21pc2UucmVzb2x2ZSgnZmlsZTEudHh0JyksICdmaWxlMi50eHQnLCAnZmlsZTMudHh0J11cbiAqICk7IC8vID0+IFByb21pc2UoMTApXG4gKlxuICogUkEucmVkdWNlUChcbiAqICAgKHRvdGFsLCBmaWxlTmFtZSkgPT4gZnNcbiAqICAgICAucmVhZEZpbGVBc3luYyhmaWxlTmFtZSwgJ3V0ZjgnKVxuICogICAgIC50aGVuKGNvbnRlbnRzID0+IHRvdGFsICsgcGFyc2VJbnQoY29udGVudHMsIDEwKSksXG4gKiAgIDAsXG4gKiAgIFByb21pc2UucmVzb2x2ZShbUHJvbWlzZS5yZXNvbHZlKCdmaWxlMS50eHQnKSwgJ2ZpbGUyLnR4dCcsICdmaWxlMy50eHQnXSlcbiAqICk7IC8vID0+IFByb21pc2UoMTApXG4gKlxuICovXG5cbi8qIGVzbGluZS1lbmFibGUgbWF4LWxlbiAqL1xudmFyIHJlZHVjZVAgPSAoMCwgX3JhbWRhLmN1cnJ5TikoMywgZnVuY3Rpb24gKGZuLCBhY2MsIGxpc3QpIHtcbiAgcmV0dXJuICgwLCBfcmVzb2x2ZVBbXCJkZWZhdWx0XCJdKShsaXN0KS50aGVuKGZ1bmN0aW9uIChpdGVyYWJsZSkge1xuICAgIHZhciBsaXN0TGVuZ3RoID0gKDAsIF9yYW1kYS5sZW5ndGgpKGl0ZXJhYmxlKTtcblxuICAgIGlmIChsaXN0TGVuZ3RoID09PSAwKSB7XG4gICAgICByZXR1cm4gYWNjO1xuICAgIH1cblxuICAgIHZhciByZWR1Y2VyID0gKDAsIF9yYW1kYS5yZWR1Y2UpKGZ1bmN0aW9uIChhY2NQLCBjdXJyZW50VmFsdWVQKSB7XG4gICAgICByZXR1cm4gYWNjUC50aGVuKGZ1bmN0aW9uIChwcmV2aW91c1ZhbHVlKSB7XG4gICAgICAgIHJldHVybiAoMCwgX2FsbFBbXCJkZWZhdWx0XCJdKShbcHJldmlvdXNWYWx1ZSwgY3VycmVudFZhbHVlUF0pO1xuICAgICAgfSkudGhlbihmdW5jdGlvbiAoX3JlZikge1xuICAgICAgICB2YXIgX3JlZjIgPSBfc2xpY2VkVG9BcnJheShfcmVmLCAyKSxcbiAgICAgICAgICAgIHByZXZpb3VzVmFsdWUgPSBfcmVmMlswXSxcbiAgICAgICAgICAgIGN1cnJlbnRWYWx1ZSA9IF9yZWYyWzFdO1xuXG4gICAgICAgIGlmICgoMCwgX2lzVW5kZWZpbmVkW1wiZGVmYXVsdFwiXSkocHJldmlvdXNWYWx1ZSkgJiYgbGlzdExlbmd0aCA9PT0gMSkge1xuICAgICAgICAgIHJldHVybiBjdXJyZW50VmFsdWU7XG4gICAgICAgIH1cblxuICAgICAgICByZXR1cm4gZm4ocHJldmlvdXNWYWx1ZSwgY3VycmVudFZhbHVlKTtcbiAgICAgIH0pO1xuICAgIH0pO1xuICAgIHJldHVybiByZWR1Y2VyKCgwLCBfcmVzb2x2ZVBbXCJkZWZhdWx0XCJdKShhY2MpLCBpdGVyYWJsZSk7XG4gIH0pO1xufSk7XG52YXIgX2RlZmF1bHQgPSByZWR1Y2VQO1xuZXhwb3J0c1tcImRlZmF1bHRcIl0gPSBfZGVmYXVsdDsiXX0=