e6f1669652f1ba42032c2a0e3734740f
"use strict";

var _interopRequireDefault = require("@babel/runtime/helpers/interopRequireDefault")["default"];

exports.__esModule = true;
exports.createConnect = createConnect;
exports["default"] = void 0;

var _extends2 = _interopRequireDefault(require("@babel/runtime/helpers/extends"));

var _objectWithoutPropertiesLoose2 = _interopRequireDefault(require("@babel/runtime/helpers/objectWithoutPropertiesLoose"));

var _connectAdvanced = _interopRequireDefault(require("../components/connectAdvanced"));

var _shallowEqual = _interopRequireDefault(require("../utils/shallowEqual"));

var _mapDispatchToProps = _interopRequireDefault(require("./mapDispatchToProps"));

var _mapStateToProps = _interopRequireDefault(require("./mapStateToProps"));

var _mergeProps = _interopRequireDefault(require("./mergeProps"));

var _selectorFactory = _interopRequireDefault(require("./selectorFactory"));

var _excluded = ["pure", "areStatesEqual", "areOwnPropsEqual", "areStatePropsEqual", "areMergedPropsEqual"];

function match(arg, factories, name) {
  for (var i = factories.length - 1; i >= 0; i--) {
    var result = factories[i](arg);
    if (result) return result;
  }

  return function (dispatch, options) {
    throw new Error("Invalid value of type " + typeof arg + " for " + name + " argument when connecting component " + options.wrappedComponentName + ".");
  };
}

function strictEqual(a, b) {
  return a === b;
}

function createConnect(_temp) {
  var _ref = _temp === void 0 ? {} : _temp,
      _ref$connectHOC = _ref.connectHOC,
      connectHOC = _ref$connectHOC === void 0 ? _connectAdvanced["default"] : _ref$connectHOC,
      _ref$mapStateToPropsF = _ref.mapStateToPropsFactories,
      mapStateToPropsFactories = _ref$mapStateToPropsF === void 0 ? _mapStateToProps["default"] : _ref$mapStateToPropsF,
      _ref$mapDispatchToPro = _ref.mapDispatchToPropsFactories,
      mapDispatchToPropsFactories = _ref$mapDispatchToPro === void 0 ? _mapDispatchToProps["default"] : _ref$mapDispatchToPro,
      _ref$mergePropsFactor = _ref.mergePropsFactories,
      mergePropsFactories = _ref$mergePropsFactor === void 0 ? _mergeProps["default"] : _ref$mergePropsFactor,
      _ref$selectorFactory = _ref.selectorFactory,
      selectorFactory = _ref$selectorFactory === void 0 ? _selectorFactory["default"] : _ref$selectorFactory;

  return function connect(mapStateToProps, mapDispatchToProps, mergeProps, _ref2) {
    if (_ref2 === void 0) {
      _ref2 = {};
    }

    var _ref3 = _ref2,
        _ref3$pure = _ref3.pure,
        pure = _ref3$pure === void 0 ? true : _ref3$pure,
        _ref3$areStatesEqual = _ref3.areStatesEqual,
        areStatesEqual = _ref3$areStatesEqual === void 0 ? strictEqual : _ref3$areStatesEqual,
        _ref3$areOwnPropsEqua = _ref3.areOwnPropsEqual,
        areOwnPropsEqual = _ref3$areOwnPropsEqua === void 0 ? _shallowEqual["default"] : _ref3$areOwnPropsEqua,
        _ref3$areStatePropsEq = _ref3.areStatePropsEqual,
        areStatePropsEqual = _ref3$areStatePropsEq === void 0 ? _shallowEqual["default"] : _ref3$areStatePropsEq,
        _ref3$areMergedPropsE = _ref3.areMergedPropsEqual,
        areMergedPropsEqual = _ref3$areMergedPropsE === void 0 ? _shallowEqual["default"] : _ref3$areMergedPropsE,
        extraOptions = (0, _objectWithoutPropertiesLoose2["default"])(_ref3, _excluded);
    var initMapStateToProps = match(mapStateToProps, mapStateToPropsFactories, 'mapStateToProps');
    var initMapDispatchToProps = match(mapDispatchToProps, mapDispatchToPropsFactories, 'mapDispatchToProps');
    var initMergeProps = match(mergeProps, mergePropsFactories, 'mergeProps');
    return connectHOC(selectorFactory, (0, _extends2["default"])({
      methodName: 'connect',
      getDisplayName: function getDisplayName(name) {
        return "Connect(" + name + ")";
      },
      shouldHandleStateChanges: Boolean(mapStateToProps),
      initMapStateToProps: initMapStateToProps,
      initMapDispatchToProps: initMapDispatchToProps,
      initMergeProps: initMergeProps,
      pure: pure,
      areStatesEqual: areStatesEqual,
      areOwnPropsEqual: areOwnPropsEqual,
      areStatePropsEqual: areStatePropsEqual,
      areMergedPropsEqual: areMergedPropsEqual
    }, extraOptions));
  };
}

var _default = createConnect();

exports["default"] = _default;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImNvbm5lY3QuanMiXSwibmFtZXMiOlsiX2ludGVyb3BSZXF1aXJlRGVmYXVsdCIsInJlcXVpcmUiLCJleHBvcnRzIiwiX19lc01vZHVsZSIsImNyZWF0ZUNvbm5lY3QiLCJfZXh0ZW5kczIiLCJfb2JqZWN0V2l0aG91dFByb3BlcnRpZXNMb29zZTIiLCJfY29ubmVjdEFkdmFuY2VkIiwiX3NoYWxsb3dFcXVhbCIsIl9tYXBEaXNwYXRjaFRvUHJvcHMiLCJfbWFwU3RhdGVUb1Byb3BzIiwiX21lcmdlUHJvcHMiLCJfc2VsZWN0b3JGYWN0b3J5IiwiX2V4Y2x1ZGVkIiwibWF0Y2giLCJhcmciLCJmYWN0b3JpZXMiLCJuYW1lIiwiaSIsImxlbmd0aCIsInJlc3VsdCIsImRpc3BhdGNoIiwib3B0aW9ucyIsIkVycm9yIiwid3JhcHBlZENvbXBvbmVudE5hbWUiLCJzdHJpY3RFcXVhbCIsImEiLCJiIiwiX3RlbXAiLCJfcmVmIiwiX3JlZiRjb25uZWN0SE9DIiwiY29ubmVjdEhPQyIsIl9yZWYkbWFwU3RhdGVUb1Byb3BzRiIsIm1hcFN0YXRlVG9Qcm9wc0ZhY3RvcmllcyIsIl9yZWYkbWFwRGlzcGF0Y2hUb1BybyIsIm1hcERpc3BhdGNoVG9Qcm9wc0ZhY3RvcmllcyIsIl9yZWYkbWVyZ2VQcm9wc0ZhY3RvciIsIm1lcmdlUHJvcHNGYWN0b3JpZXMiLCJfcmVmJHNlbGVjdG9yRmFjdG9yeSIsInNlbGVjdG9yRmFjdG9yeSIsImNvbm5lY3QiLCJtYXBTdGF0ZVRvUHJvcHMiLCJtYXBEaXNwYXRjaFRvUHJvcHMiLCJtZXJnZVByb3BzIiwiX3JlZjIiLCJfcmVmMyIsIl9yZWYzJHB1cmUiLCJwdXJlIiwiX3JlZjMkYXJlU3RhdGVzRXF1YWwiLCJhcmVTdGF0ZXNFcXVhbCIsIl9yZWYzJGFyZU93blByb3BzRXF1YSIsImFyZU93blByb3BzRXF1YWwiLCJfcmVmMyRhcmVTdGF0ZVByb3BzRXEiLCJhcmVTdGF0ZVByb3BzRXF1YWwiLCJfcmVmMyRhcmVNZXJnZWRQcm9wc0UiLCJhcmVNZXJnZWRQcm9wc0VxdWFsIiwiZXh0cmFPcHRpb25zIiwiaW5pdE1hcFN0YXRlVG9Qcm9wcyIsImluaXRNYXBEaXNwYXRjaFRvUHJvcHMiLCJpbml0TWVyZ2VQcm9wcyIsIm1ldGhvZE5hbWUiLCJnZXREaXNwbGF5TmFtZSIsInNob3VsZEhhbmRsZVN0YXRlQ2hhbmdlcyIsIkJvb2xlYW4iLCJfZGVmYXVsdCJdLCJtYXBwaW5ncyI6IkFBQUE7O0FBRUEsSUFBSUEsc0JBQXNCLEdBQUdDLE9BQU8sQ0FBQyw4Q0FBRCxDQUFQLENBQXdELFNBQXhELENBQTdCOztBQUVBQyxPQUFPLENBQUNDLFVBQVIsR0FBcUIsSUFBckI7QUFDQUQsT0FBTyxDQUFDRSxhQUFSLEdBQXdCQSxhQUF4QjtBQUNBRixPQUFPLENBQUMsU0FBRCxDQUFQLEdBQXFCLEtBQUssQ0FBMUI7O0FBRUEsSUFBSUcsU0FBUyxHQUFHTCxzQkFBc0IsQ0FBQ0MsT0FBTyxDQUFDLGdDQUFELENBQVIsQ0FBdEM7O0FBRUEsSUFBSUssOEJBQThCLEdBQUdOLHNCQUFzQixDQUFDQyxPQUFPLENBQUMscURBQUQsQ0FBUixDQUEzRDs7QUFFQSxJQUFJTSxnQkFBZ0IsR0FBR1Asc0JBQXNCLENBQUNDLE9BQU8sQ0FBQywrQkFBRCxDQUFSLENBQTdDOztBQUVBLElBQUlPLGFBQWEsR0FBR1Isc0JBQXNCLENBQUNDLE9BQU8sQ0FBQyx1QkFBRCxDQUFSLENBQTFDOztBQUVBLElBQUlRLG1CQUFtQixHQUFHVCxzQkFBc0IsQ0FBQ0MsT0FBTyxDQUFDLHNCQUFELENBQVIsQ0FBaEQ7O0FBRUEsSUFBSVMsZ0JBQWdCLEdBQUdWLHNCQUFzQixDQUFDQyxPQUFPLENBQUMsbUJBQUQsQ0FBUixDQUE3Qzs7QUFFQSxJQUFJVSxXQUFXLEdBQUdYLHNCQUFzQixDQUFDQyxPQUFPLENBQUMsY0FBRCxDQUFSLENBQXhDOztBQUVBLElBQUlXLGdCQUFnQixHQUFHWixzQkFBc0IsQ0FBQ0MsT0FBTyxDQUFDLG1CQUFELENBQVIsQ0FBN0M7O0FBRUEsSUFB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QSx3QkFBd0IsRUFBRUMsT0FBTyxDQUFDdEIsZUFBRCxDQVIwQjtBQVUzRGdCLE1BQUFBLG1CQUFtQixFQUFFQSxtQkFWc0M7QUFXM0RDLE1BQUFBLHNCQUFzQixFQUFFQSxzQkFYbUM7QUFZM0RDLE1BQUFBLGNBQWMsRUFBRUEsY0FaMkM7QUFhM0RaLE1BQUFBLElBQUksRUFBRUEsSUFicUQ7QUFjM0RFLE1BQUFBLGNBQWMsRUFBRUEsY0FkMkM7QUFlM0RFLE1BQUFBLGdCQUFnQixFQUFFQSxnQkFmeUM7QUFnQjNERSxNQUFBQSxrQkFBa0IsRUFBRUEsa0JBaEJ1QztBQWlCM0RFLE1BQUFBLG1CQUFtQixFQUFFQTtBQWpCc0MsS0FBMUIsRUFrQmhDQyxZQWxCZ0MsQ0FBbEIsQ0FBakI7QUFtQkQsR0F2Q0Q7QUF3Q0Q7O0FBRUQsSUFBSVEsUUFBUSxHQUFnQjVELGFBQWEsRUFBekM7O0FBRUFGLE9BQU8sQ0FBQyxTQUFELENBQVAsR0FBcUI4RCxRQUFyQiIsInNvdXJjZXNDb250ZW50IjpbIlwidXNlIHN0cmljdFwiO1xuXG52YXIgX2ludGVyb3BSZXF1aXJlRGVmYXVsdCA9IHJlcXVpcmUoXCJAYmFiZWwvcnVudGltZS9oZWxwZXJzL2ludGVyb3BSZXF1aXJlRGVmYXVsdFwiKVtcImRlZmF1bHRcIl07XG5cbmV4cG9ydHMuX19lc01vZHVsZSA9IHRydWU7XG5leHBvcnRzLmNyZWF0ZUNvbm5lY3QgPSBjcmVhdGVDb25uZWN0O1xuZXhwb3J0c1tcImRlZmF1bHRcIl0gPSB2b2lkIDA7XG5cbnZhciBfZXh0ZW5kczIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KHJlcXVpcmUoXCJAYmFiZWwvcnVudGltZS9oZWxwZXJzL2V4dGVuZHNcIikpO1xuXG52YXIgX29iamVjdFdpdGhvdXRQcm9wZXJ0aWVzTG9vc2UyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChyZXF1aXJlKFwiQGJhYmVsL3J1bnRpbWUvaGVscGVycy9vYmplY3RXaXRob3V0UHJvcGVydGllc0xvb3NlXCIpKTtcblxudmFyIF9jb25uZWN0QWR2YW5jZWQgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KHJlcXVpcmUoXCIuLi9jb21wb25lbnRzL2Nvbm5lY3RBZHZhbmNlZFwiKSk7XG5cbnZhciBfc2hhbGxvd0VxdWFsID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChyZXF1aXJlKFwiLi4vdXRpbHMvc2hhbGxvd0VxdWFsXCIpKTtcblxudmFyIF9tYXBEaXNwYXRjaFRvUHJvcHMgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KHJlcXVpcmUoXCIuL21hcERpc3BhdGNoVG9Qcm9wc1wiKSk7XG5cbnZhciBfbWFwU3RhdGVUb1Byb3BzID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChyZXF1aXJlKFwiLi9tYXBTdGF0ZVRvUHJvcHNcIikpO1xuXG52YXIgX21lcmdlUHJvcHMgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KHJlcXVpcmUoXCIuL21lcmdlUHJvcHNcIikpO1xuXG52YXIgX3NlbGVjdG9yRmFjdG9yeSA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQocmVxdWlyZShcIi4vc2VsZWN0b3JGYWN0b3J5XCIpKTtcblxudmFyIF9leGNsdWRlZCA9IFtcInB1cmVcIiwgXCJhcmVTdGF0ZXNFcXVhbFwiLCBcImFyZU93blByb3BzRXF1YWxcIiwgXCJhcmVTdGF0ZVByb3BzRXF1YWxcIiwgXCJhcmVNZXJnZWRQcm9wc0VxdWFsXCJdO1xuXG4vKlxuICBjb25uZWN0IGlzIGEgZmFjYWRlIG92ZXIgY29ubmVjdEFkdmFuY2VkLiBJdCB0dXJucyBpdHMgYXJncyBpbnRvIGEgY29tcGF0aWJsZVxuICBzZWxlY3RvckZhY3RvcnksIHdoaWNoIGhhcyB0aGUgc2lnbmF0dXJlOlxuXG4gICAgKGRpc3BhdGNoLCBvcHRpb25zKSA9PiAobmV4dFN0YXRlLCBuZXh0T3duUHJvcHMpID0+IG5leHRGaW5hbFByb3BzXG4gIFxuICBjb25uZWN0IHBhc3NlcyBpdHMgYXJncyB0byBjb25uZWN0QWR2YW5jZWQgYXMgb3B0aW9ucywgd2hpY2ggd2lsbCBpbiB0dXJuIHBhc3MgdGhlbSB0b1xuICBzZWxlY3RvckZhY3RvcnkgZWFjaCB0aW1lIGEgQ29ubmVjdCBjb21wb25lbnQgaW5zdGFuY2UgaXMgaW5zdGFudGlhdGVkIG9yIGhvdCByZWxvYWRlZC5cblxuICBzZWxlY3RvckZhY3RvcnkgcmV0dXJucyBhIGZpbmFsIHByb3BzIHNlbGVjdG9yIGZyb20gaXRzIG1hcFN0YXRlVG9Qcm9wcyxcbiAgbWFwU3RhdGVUb1Byb3BzRmFjdG9yaWVzLCBtYXBEaXNwYXRjaFRvUHJvcHMsIG1hcERpc3BhdGNoVG9Qcm9wc0ZhY3RvcmllcywgbWVyZ2VQcm9wcyxcbiAgbWVyZ2VQcm9wc0ZhY3RvcmllcywgYW5kIHB1cmUgYXJncy5cblxuICBUaGUgcmVzdWx0aW5nIGZpbmFsIHByb3BzIHNlbGVjdG9yIGlzIGNhbGxlZCBieSB0aGUgQ29ubmVjdCBjb21wb25lbnQgaW5zdGFuY2Ugd2hlbmV2ZXJcbiAgaXQgcmVjZWl2ZXMgbmV3IHByb3BzIG9yIHN0b3JlIHN0YXRlLlxuICovXG5mdW5jdGlvbiBtYXRjaChhcmcsIGZhY3RvcmllcywgbmFtZSkge1xuICBmb3IgKHZhciBpID0gZmFjdG9yaWVzLmxlbmd0aCAtIDE7IGkgPj0gMDsgaS0tKSB7XG4gICAgdmFyIHJlc3VsdCA9IGZhY3Rvcmllc1tpXShhcmcpO1xuICAgIGlmIChyZXN1bHQpIHJldHVybiByZXN1bHQ7XG4gIH1cblxuICByZXR1cm4gZnVuY3Rpb24gKGRpc3BhdGNoLCBvcHRpb25zKSB7XG4gICAgdGhyb3cgbmV3IEVycm9yKFwiSW52YWxpZCB2YWx1ZSBvZiB0eXBlIFwiICsgdHlwZW9mIGFyZyArIFwiIGZvciBcIiArIG5hbWUgKyBcIiBhcmd1bWVudCB3aGVuIGNvbm5lY3RpbmcgY29tcG9uZW50IFwiICsgb3B0aW9ucy53cmFwcGVkQ29tcG9uZW50TmFtZSArIFwiLlwiKTtcbiAgfTtcbn1cblxuZnVuY3Rpb24gc3RyaWN0RXF1YWwoYSwgYikge1xuICByZXR1cm4gYSA9PT0gYjtcbn0gLy8gY3JlYXRlQ29ubmVjdCB3aXRoIGRlZmF1bHQgYXJncyBidWlsZHMgdGhlICdvZmZpY2lhbCcgY29ubmVjdCBiZWhhdmlvci4gQ2FsbGluZyBpdCB3aXRoXG4vLyBkaWZmZXJlbnQgb3B0aW9ucyBvcGVucyB1cCBzb21lIHRlc3RpbmcgYW5kIGV4dGVuc2liaWxpdHkgc2NlbmFyaW9zXG5cblxuZnVuY3Rpb24gY3JlYXRlQ29ubmVjdChfdGVtcCkge1xuICB2YXIgX3JlZiA9IF90ZW1wID09PSB2b2lkIDAgPyB7fSA6IF90ZW1wLFxuICAgICAgX3JlZiRjb25uZWN0SE9DID0gX3JlZi5jb25uZWN0SE9DLFxuICAgICAgY29ubmVjdEhPQyA9IF9yZWYkY29ubmVjdEhPQyA9PT0gdm9pZCAwID8gX2Nvbm5lY3RBZHZhbmNlZFtcImRlZmF1bHRcIl0gOiBfcmVmJGNvbm5lY3RIT0MsXG4gICAgICBfcmVmJG1hcFN0YXRlVG9Qcm9wc0YgPSBfcmVmLm1hcFN0YXRlVG9Qcm9wc0ZhY3RvcmllcyxcbiAgICAgIG1hcFN0YXRlVG9Qcm9wc0ZhY3RvcmllcyA9IF9yZWYkbWFwU3RhdGVUb1Byb3BzRiA9PT0gdm9pZCAwID8gX21hcFN0YXRlVG9Qcm9wc1tcImRlZmF1bHRcIl0gOiBfcmVmJG1hcFN0YXRlVG9Qcm9wc0YsXG4gICAgICBfcmVmJG1hcERpc3BhdGNoVG9Qcm8gPSBfcmVmLm1hcERpc3BhdGNoVG9Qcm9wc0ZhY3RvcmllcyxcbiAgICAgIG1hcERpc3BhdGNoVG9Qcm9wc0ZhY3RvcmllcyA9IF9yZWYkbWFwRGlzcGF0Y2hUb1BybyA9PT0gdm9pZCAwID8gX21hcERpc3BhdGNoVG9Qcm9wc1tcImRlZmF1bHRcIl0gOiBfcmVmJG1hcERpc3BhdGNoVG9Qcm8sXG4gICAgICBfcmVmJG1lcmdlUHJvcHNGYWN0b3IgPSBfcmVmLm1lcmdlUHJvcHNGYWN0b3JpZXMsXG4gICAgICBtZXJnZVByb3BzRmFjdG9yaWVzID0gX3JlZiRtZXJnZVByb3BzRmFjdG9yID09PSB2b2lkIDAgPyBfbWVyZ2VQcm9wc1tcImRlZmF1bHRcIl0gOiBfcmVmJG1lcmdlUHJvcHNGYWN0b3IsXG4gICAgICBfcmVmJHNlbGVjdG9yRmFjdG9yeSA9IF9yZWYuc2VsZWN0b3JGYWN0b3J5LFxuICAgICAgc2VsZWN0b3JGYWN0b3J5ID0gX3JlZiRzZWxlY3RvckZhY3RvcnkgPT09IHZvaWQgMCA/IF9zZWxlY3RvckZhY3RvcnlbXCJkZWZhdWx0XCJdIDogX3JlZiRzZWxlY3RvckZhY3Rvcnk7XG5cbiAgcmV0dXJuIGZ1bmN0aW9uIGNvbm5lY3QobWFwU3RhdGVUb1Byb3BzLCBtYXBEaXNwYXRjaFRvUHJvcHMsIG1lcmdlUHJvcHMsIF9yZWYyKSB7XG4gICAgaWYgKF9yZWYyID09PSB2b2lkIDApIHtcbiAgICAgIF9yZWYyID0ge307XG4gICAgfVxuXG4gICAgdmFyIF9yZWYzID0gX3JlZjIsXG4gICAgICAgIF9yZWYzJHB1cmUgPSBfcmVmMy5wdXJlLFxuICAgICAgICBwdXJlID0gX3JlZjMkcHVyZSA9PT0gdm9pZCAwID8gdHJ1ZSA6IF9yZWYzJHB1cmUsXG4gICAgICAgIF9yZWYzJGFyZVN0YXRlc0VxdWFsID0gX3JlZjMuYXJlU3RhdGVzRXF1YWwsXG4gICAgICAgIGFyZVN0YXRlc0VxdWFsID0gX3JlZjMkYXJlU3RhdGVzRXF1YWwgPT09IHZvaWQgMCA/IHN0cmljdEVxdWFsIDogX3JlZjMkYXJlU3RhdGVzRXF1YWwsXG4gICAgICAgIF9yZWYzJGFyZU93blByb3BzRXF1YSA9IF9yZWYzLmFyZU93blByb3BzRXF1YWwsXG4gICAgICAgIGFyZU93blByb3BzRXF1YWwgPSBfcmVmMyRhcmVPd25Qcm9wc0VxdWEgPT09IHZvaWQgMCA/IF9zaGFsbG93RXF1YWxbXCJkZWZhdWx0XCJdIDogX3JlZjMkYXJlT3duUHJvcHNFcXVhLFxuICAgICAgICBfcmVmMyRhcmVTdGF0ZVByb3BzRXEgPSBfcmVmMy5hcmVTdGF0ZVByb3BzRXF1YWwsXG4gICAgICAgIGFyZVN0YXRlUHJvcHNFcXVhbCA9IF9yZWYzJGFyZVN0YXRlUHJvcHNFcSA9PT0gdm9pZCAwID8gX3NoYWxsb3dFcXVhbFtcImRlZmF1bHRcIl0gOiBfcmVmMyRhcmVTdGF0ZVByb3BzRXEsXG4gICAgICAgIF9yZWYzJGFyZU1lcmdlZFByb3BzRSA9IF9yZWYzLmFyZU1lcmdlZFByb3BzRXF1YWwsXG4gICAgICAgIGFyZU1lcmdlZFByb3BzRXF1YWwgPSBfcmVmMyRhcmVNZXJnZWRQcm9wc0UgPT09IHZvaWQgMCA/IF9zaGFsbG93RXF1YWxbXCJkZWZhdWx0XCJdIDogX3JlZjMkYXJlTWVyZ2VkUHJvcHNFLFxuICAgICAgICBleHRyYU9wdGlvbnMgPSAoMCwgX29iamVjdFdpdGhvdXRQcm9wZXJ0aWVzTG9vc2UyW1wiZGVmYXVsdFwiXSkoX3JlZjMsIF9leGNsdWRlZCk7XG4gICAgdmFyIGluaXRNYXBTdGF0ZVRvUHJvcHMgPSBtYXRjaChtYXBTdGF0ZVRvUHJvcHMsIG1hcFN0YXRlVG9Qcm9wc0ZhY3RvcmllcywgJ21hcFN0YXRlVG9Qcm9wcycpO1xuICAgIHZhciBpbml0TWFwRGlzcGF0Y2hUb1Byb3BzID0gbWF0Y2gobWFwRGlzcGF0Y2hUb1Byb3BzLCBtYXBEaXNwYXRjaFRvUHJvcHNGYWN0b3JpZXMsICdtYXBEaXNwYXRjaFRvUHJvcHMnKTtcbiAgICB2YXIgaW5pdE1lcmdlUHJvcHMgPSBtYXRjaChtZXJnZVByb3BzLCBtZXJnZVByb3BzRmFjdG9yaWVzLCAnbWVyZ2VQcm9wcycpO1xuICAgIHJldHVybiBjb25uZWN0SE9DKHNlbGVjdG9yRmFjdG9yeSwgKDAsIF9leHRlbmRzMltcImRlZmF1bHRcIl0pKHtcbiAgICAgIC8vIHVzZWQgaW4gZXJyb3IgbWVzc2FnZXNcbiAgICAgIG1ldGhvZE5hbWU6ICdjb25uZWN0JyxcbiAgICAgIC8vIHVzZWQgdG8gY29tcHV0ZSBDb25uZWN0J3MgZGlzcGxheU5hbWUgZnJvbSB0aGUgd3JhcHBlZCBjb21wb25lbnQncyBkaXNwbGF5TmFtZS5cbiAgICAgIGdldERpc3BsYXlOYW1lOiBmdW5jdGlvbiBnZXREaXNwbGF5TmFtZShuYW1lKSB7XG4gICAgICAgIHJldHVybiBcIkNvbm5lY3QoXCIgKyBuYW1lICsgXCIpXCI7XG4gICAgICB9LFxuICAgICAgLy8gaWYgbWFwU3RhdGVUb1Byb3BzIGlzIGZhbHN5LCB0aGUgQ29ubmVjdCBjb21wb25lbnQgZG9lc24ndCBzdWJzY3JpYmUgdG8gc3RvcmUgc3RhdGUgY2hhbmdlc1xuICAgICAgc2hvdWxkSGFuZGxlU3RhdGVDaGFuZ2VzOiBCb29sZWFuKG1hcFN0YXRlVG9Qcm9wcyksXG4gICAgICAvLyBwYXNzZWQgdGhyb3VnaCB0byBzZWxlY3RvckZhY3RvcnlcbiAgICAgIGluaXRNYXBTdGF0ZVRvUHJvcHM6IGluaXRNYXBTdGF0ZVRvUHJvcHMsXG4gICAgICBpbml0TWFwRGlzcGF0Y2hUb1Byb3BzOiBpbml0TWFwRGlzcGF0Y2hUb1Byb3BzLFxuICAgICAgaW5pdE1lcmdlUHJvcHM6IGluaXRNZXJnZVByb3BzLFxuICAgICAgcHVyZTogcHVyZSxcbiAgICAgIGFyZVN0YXRlc0VxdWFsOiBhcmVTdGF0ZXNFcXVhbCxcbiAgICAgIGFyZU93blByb3BzRXF1YWw6IGFyZU93blByb3BzRXF1YWwsXG4gICAgICBhcmVTdGF0ZVByb3BzRXF1YWw6IGFyZVN0YXRlUHJvcHNFcXVhbCxcbiAgICAgIGFyZU1lcmdlZFByb3BzRXF1YWw6IGFyZU1lcmdlZFByb3BzRXF1YWxcbiAgICB9LCBleHRyYU9wdGlvbnMpKTtcbiAgfTtcbn1cblxudmFyIF9kZWZhdWx0ID0gLyojX19QVVJFX18qL2NyZWF0ZUNvbm5lY3QoKTtcblxuZXhwb3J0c1tcImRlZmF1bHRcIl0gPSBfZGVmYXVsdDsiXX0=